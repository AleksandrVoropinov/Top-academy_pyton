--1.
--CREATE TABLE pilots (
--    PILOT_ID SERIAL PRIMARY KEY,
--    PILOT_NAME VARCHAR(100) NOT NULL,
--    EXPIPIRIENCE INTEGER
--);
--2.
--INSERT INTO pilots(PILOT_NAME, EXPIPIRIENCE)
--VALUES ('Иван', 5), ('Петр', 2), ('Павел', 7), ('Борис', 1);
--3.
--ALTER TABLE pilots
--ADD COLUMN PHONE VARCHAR(15) NOT NULL DEFAULT '0';
--UPDATE pilots SET PHONE = '+79222001717';
--4.
--CREATE VIEW NAME AS
--SELECT AIRPORT_CODE, AIRPORT_NAME, CITY
--FROM AIRPORTS_DATA;
--5.
--DROP VIEW SIBERIAN_AIRPORTS
--CREATE VIEW SIBERIAN_AIRPORTS AS
--SELECT * FROM AIRPORTS_DATA WHERE CITY->>'ru' IN ('Новосибирск', 'Кемерово');
--SELECT * FROM SIBERIAN_AIRPORTS;
--8.
--CREATE VIEW PASSENGERS AS
--SELECT PASSENGER_NAME, TICKET_NO FROM TICKETS
--WHERE TICKET_NO IN (SELECT TICKET_NO FROM TICKET_FLIGHTS WHERE FLIGHT_ID
--IN (SELECT FLIGHT_ID FROM FLIGHTS WHERE
--   SCHEDULED_DEPARTURE >='2017-09-05 11:15:00+05'
--   AND SCHEDULED_DEPARTURE <= '2017-09-05 17:15:00+05'
--   AND DEPARTURE_AIRPORT = 'DME'));
--9.
--SELECT AVG(SCHEDULED_ARRIVAL - SCHEDULED_DEPARTURE) FROM FLIGHTS
--WHERE (ARRIVAL_AIRPORT IN ('DME', 'SVO', 'VKO', 'ZIO') AND DEPARTURE_AIRPORT = 'KZN')
--OR (ARRIVAL_AIRPORT = 'KZN' AND DEPARTURE_AIRPORT IN ('DME', 'SVO', 'ZIO'));