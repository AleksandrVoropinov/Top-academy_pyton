--ПРЕДСТАВЛЕНИЯ:
--1.
--SELECT COUNT(*) AS COUNT FROM BOOKINGS WHERE TOTAL_AMOUNT > (SELECT AVG(TOTAL_AMOUNT) FROM BOOKINGS);
--2.
--INSERT INTO SEATS(AICRAFT_CODE, SEAT_NO, FARE_CONDITIONS)
--VALUES
--(
--    763,
--	'40D',
--	(SELECT FARE_CONDITIONS FROM SEATS WHERE SEAT_NO = '2A' AND AIRCRAFT_CODE = '319')
--);
--INSERT INTO SEATS(AICRAFT_CODE, SEAT_NO, FARE_CONDITIONS)
--VALUES
--(
--    763,
--	'40F',
--	(SELECT FARE_CONDITIONS FROM SEATS WHERE SEAT_NO = '2A' AND AIRCRAFT_CODE = '319')
--);
--8.
--UPDATE TICKETS SET PASSENGER_NAME = REPLACE(PASSENGER_NAME, 'IVAN', 'EGOR')
--WHERE BOOK_REF IN (SELECT BOOK_REF FROM BOOKINGS WHERE BOOK_DATE = '2017-07-24 23:18:00+05')
--AND LEFT (PASSENGER_NAME, 4) = 'IVAN';

--ОБЪЕДИНЕНИЕ ТАБЛИЦ:
--1.
--SELECT AIRCRAFTS_DATA.AIRCRAFT_CODE, AIRCRAFTS_DATA.MODEL, SEATS.SEAT_NO, SEATS.FARE_CONDITIONS
--FROM AIRCRAFTS_DATA
--JOIN SEATS ON SEATS.AIRCRAFT_CODE = AIRCRAFTS_DATA.AIRCRAFT_CODE
--WHERE MODEL->>'en' LIKE 'Airbus A319-100' ORDER BY SEATS.SEAT_NO;
--2.
--SELECT TICKETS.PASSENGER_NAME, FLIGHTS.DEPARTURE_AIRPORT, FLIGHTS.STATUS, TICKET_FLIGHTS.AMOUNT
--FROM TICKETS
--JOIN TICKET_FLIGHTS ON TICKET_FLIGHTS.TICKET_NO = TICKETS.TICKET_NO 
--JOIN FLIGHTS ON FLIGHTS.FLIGHT_ID = TICKET_FLIGHTS.FLIGHTS_ID
--WHERE LEFT(TICKETS.PASSENGER_ID, 4)  LIKE '5657';

--ПРЕДСТАВЛЕНИЯ:
--CREATE VIEW SEATS_BY_FARE_CONDITIONS AS
--  SELECT AIRCRAFT_CODE, FARE_CONDITIONS, COUNT(*)
--  FROM SEATS
--  GROUP BY AIRCRAFT_CODE, FARE_CONDITIONS
--  ORDER BY AIRCRAFT_CODE, FARE_CONDITIONS;
--DROP VIEW [SEATS_BY_FARE_CONDITIONS]
--6.
--CREATE VIEW CITIES AS
--  SELECT CITY->>'ru' AS CITY FROM AIRPORTS_DATA WHERE AIRPORT_CODE
--  IN (SELECT DISTINCT ARRIVAL_AIRPORT FROM FLIGHTS WHERE DEPARTURE_AIRPORT
--    IN(SELECT AIRPORT_CODE FROM AIRPORTS_DATA WHERE CITY->>'ru'
--	   IN('Москва', 'Санкт-Петербург'))) ORDER BY CITY DESC;
--6.
--INSERT INTO AIRCRAFTS_DATA (AIRCRAFT_CODE, MODEL, RANGE)
--VALUES (111, '{"en": "Boeing 111", "ru": "Боинг 111"}', 5000),
--       (222, '{"en": "Boeing 222", "ru": "Боинг 222"}', 6000);
--SELECT FLIGHTS.FLIGHT_ID, FLIGHTS.STATUS, AIRCRAFTS_DATA.AIRCRAFT_CODE, AIRCRAFTS_DATA.MODEL
--FROM AIRCRAFTS_DATA
--LEFT JOIN FLIGHTS ON FLIGHTS.AIRCRAFT_CODE = AIRCRAFTS_DATA.AIRCRAFT_CODE
--ORDER BY AIRCRAFTS_DATA ASC;	   
--7.
--CREATE VIEW FLIGHTS_CITY AS
--  SELECT AIRPORTS_DATA.CITY->>'ru' AS CITY, COUNT(*) AS COUNT_FLIGHTS
--  FROM FLIGHTS
--  JOIN AIRPORTS_DATA ON AIRPORTS_DATA.AIRPORT_CODE = FLIGHTS.DEPARTURE_AIRPORT
--  GROUP BY AIRPORTS_DATA.CITY;
--SELECT * FROM FLIGHTS_CITY WHERE CITY LIKE 'А%'; 
